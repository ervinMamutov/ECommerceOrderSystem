# ==============================================
# PRODUCTION ENVIRONMENT CONFIGURATION
# ==============================================
# This file is activated when SPRING_PROFILES_ACTIVE=prod

# -------------------- Database Configuration --------------------
# NEVER show SQL in production logs
spring.jpa.show-sql=false

# Use validate mode - schema changes must be done via migrations
spring.jpa.hibernate.ddl-auto=validate

# Production-optimized JPA settings
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true

# Connection pool settings for production
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000

# -------------------- Logging Configuration --------------------
# Production logging levels - only important information
logging.level.com.example.e_commerce=INFO
logging.level.org.springframework=WARN
logging.level.org.hibernate=WARN

# Log to file in production
logging.file.name=/var/log/ecommerce/application.log
logging.file.max-size=10MB
logging.file.max-history=30

# Use JSON format for log aggregation systems
# Uncomment if using ELK, Splunk, etc.
# logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n

# -------------------- Security Configuration --------------------
# Hide error details from users
server.error.include-message=never
server.error.include-binding-errors=never
server.error.include-stacktrace=never
server.error.include-exception=false

# Security headers
server.servlet.session.cookie.secure=true
server.servlet.session.cookie.http-only=true
server.servlet.session.cookie.same-site=strict

# -------------------- Performance & Caching --------------------
# Enable caching for static resources
spring.web.resources.cache.period=31536000
spring.web.resources.chain.strategy.content.enabled=true
spring.web.resources.chain.strategy.content.paths=/**

# Enable compression
server.compression.enabled=true
server.compression.mime-types=text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json,application/xml

# -------------------- Actuator Configuration --------------------
# Expose only health and info endpoints in production
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=when-authorized
management.metrics.export.prometheus.enabled=true

# -------------------- SSL/TLS Configuration --------------------
# Uncomment and configure if using HTTPS directly (recommended to use reverse proxy)
# server.ssl.enabled=true
# server.ssl.key-store=/path/to/keystore.p12
# server.ssl.key-store-password=${SSL_KEYSTORE_PASSWORD}
# server.ssl.key-store-type=PKCS12
# server.ssl.key-alias=tomcat

# -------------------- Production Specific Settings --------------------
# Disable DevTools
spring.devtools.restart.enabled=false
spring.devtools.livereload.enabled=false

# Strict request parsing
server.tomcat.reject-illegal-header=true

# Production database migration settings
spring.flyway.enabled=true
spring.flyway.validate-on-migrate=true
spring.flyway.clean-disabled=true
